<!DOCTYPE html>
<html lang="sv">
<head>
  <meta name="x-generation-source" content="local-fallback" />
  <meta name="x-feature-goal-template-version" content="v2" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Offer</title>
  <style>
    :root {
      --primary: #1d4ed8;
      --text-strong: #0f172a;
      --text-muted: #64748b;
      --border: #e2e8f0;
      --accent: #e0e7ff;
      --bg-light: #f8f9fa;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      margin: 0;
      padding: 24px;
      background: #ffffff;
      color: var(--text-strong);
      line-height: 1.6;
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      font-size: 2rem;
      margin: 0 0 32px;
      border-bottom: 2px solid var(--border);
      padding-bottom: 12px;
      color: var(--text-strong);
    }
    h2 {
      color: var(--primary);
      margin: 0;
      font-size: 1.5rem;
    }
    h3 {
      color: var(--text-strong);
      margin: 32px 0 12px;
      font-size: 1.2rem;
    }
    p { margin: 0 0 12px; }
    ul {
      padding-left: 24px;
      margin: 0 0 16px;
    }
    li { margin-bottom: 8px; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
      background: white;
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
    }
    table th,
    table td {
      border-bottom: 1px solid var(--border);
      padding: 12px;
      text-align: left;
    }
    table th {
      background: var(--accent);
      color: var(--primary);
      font-weight: 600;
    }
    table tr:last-child td {
      border-bottom: none;
    }
    .muted {
      color: var(--text-muted);
      font-size: 0.9rem;
      font-style: italic;
    }
    .card {
      background: var(--bg-light);
      padding: 20px;
      border-radius: 8px;
      margin: 16px 0;
      border-left: 4px solid var(--primary);
    }
    .doc-section {
      margin-bottom: 16px;
      background: white;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
    }
    .doc-section details {
      margin: 0;
    }
    .doc-section details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary);
      padding: 16px 20px;
      background: var(--bg-light);
      border-bottom: 1px solid var(--border);
      user-select: none;
      font-size: 1.5rem;
      list-style: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .doc-section details summary::-webkit-details-marker {
      display: none;
    }
    .doc-section details summary::before {
      content: '‚ñ∂';
      display: inline-block;
      transition: transform 0.2s;
      font-size: 0.8rem;
      color: var(--primary);
    }
    .doc-section details[open] summary::before {
      transform: rotate(90deg);
    }
    .doc-section details summary:hover {
      background: var(--accent);
    }
    .doc-section details .section-content {
      padding: 20px;
    }
    .doc-section details[open] summary {
      border-bottom: 1px solid var(--border);
    }
    .doc-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--accent);
      color: var(--primary);
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .local-version-badge {
      background: #e0f2fe;
      color: #0369a1;
      padding: 8px 16px;
      margin: 16px 0;
      border-radius: 6px;
      border-left: 4px solid #0284c7;
      font-size: 0.9rem;
      font-weight: 500;
    }
    .llm-fallback-banner {
      padding: 8px 12px;
      margin-bottom: 16px;
      border-radius: 6px;
      background-color: #fefce8;
      color: #854d0e;
      border: 1px solid #fef9c3;
      font-size: 0.85rem;
    }
    .llm-fallback-badge {
      display: inline-block;
      padding: 4px 8px;
      margin-bottom: 12px;
      border-radius: 4px;
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
      font-size: 0.9rem;
      font-weight: 600;
    }
    .llm-fallback-details {
      font-size: 0.8rem;
      color: #4b5563;
      margin-bottom: 16px;
      white-space: pre-wrap;
    }
    .llm-fallback-local-note {
      font-size: 0.8rem;
      color: #2563eb;
      margin-bottom: 16px;
    }
    details {
      margin: 16px 0;
    }
    details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary);
      padding: 12px;
      background: var(--bg-light);
      border: 1px solid var(--border);
      border-radius: 6px;
      user-select: none;
    }
    details summary:hover {
      background: var(--accent);
    }
    details[open] summary {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }
    details .collapsible-content {
      padding: 16px;
      border: 1px solid var(--border);
      border-top: none;
      border-radius: 0 0 6px 6px;
      margin-top: 0;
    }
    img {
      max-width: 100%;
      height: auto;
      border: 1px solid var(--border);
      border-radius: 4px;
      margin: 12px 0;
    }
    a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }
    a:hover { text-decoration: underline; }
</style>
</head>
<body>
  <div class="local-version-badge" style="background: #e0f2fe; color: #0369a1; padding: 8px 16px; margin: 16px; border-radius: 6px; border-left: 4px solid #0284c7; font-size: 0.9rem; font-weight: 500;">
      üìÑ Lokal version ‚Äì F√∂rb√§ttrat inneh√•ll
    </div>
  
    
      


    
    <section class="doc-section">
      <details open>
        <summary>Beskrivning av FGoal</summary>
        <div class="section-content">
      <p>Offer preparation √§r en process d√§r systemet f√∂rbereder och presenterar ett l√•neerbjudande till kunden efter att kreditbeslut har fattats. Processen anropas fr√•n Mortgage huvudprocessen n√§r kreditbeslut √§r godk√§nt och syftar till att l√•ta kunden acceptera, avvisa eller beg√§ra √§ndringar i erbjudandet.</p>
      <p>Processen b√∂rjar med att systemet kontrollerar om k√∂pekontrakt √§r bed√∂mt. Om kontraktet inte √§r bed√∂mt, kan kunden ladda upp k√∂pekontrakt som sedan bed√∂ms via "Documentation assessment" call activity. Om dokumentation √§r ofullst√§ndig, loopar processen tillbaka f√∂r att beg√§ra komplettering. N√§r k√∂pekontrakt √§r bed√∂mt, presenteras erbjudandet till kunden via "Decide on offer" user task. Kunden kan acceptera erbjudandet (med validering av l√•nebelopp, kontonummer, datum), avvisa erbjudandet, eller beg√§ra √§ndringar. Om kunden beg√§r √§ndringar, utf√∂rs avancerad underwriting och ytterligare kreditbeslut. Om erbjudandet l√∂per ut, triggas timeout. Processen kan loopa f√∂r att hantera √§ndringar.</p>
        </div>
      </details>
    </section>
<section class="doc-section">
      <details>
        <summary>Processteg - Input</summary>
        <div class="section-content">
      <p>Offer preparation-processen startar n√§r:</p>
      <ul>
        <li><strong>Kreditbeslut √§r godk√§nt:</strong> Huvudprocessen (Mortgage) har slutf√∂rt kreditbeslut och det √§r godk√§nt, vilket indikerar att ett erbjudande kan presenteras</li>
        <li><strong>Processkontext:</strong> Offer anropas fr√•n Mortgage huvudprocessen via "Offer preparation" call activity n√§r kreditbeslut √§r godk√§nt. Alla relevanta processvariabler skickas med f√∂r att s√§kerst√§lla fullst√§ndig kontext</li>
        <li><strong>Erbjudandeinformation √§r tillg√§nglig:</strong> All n√∂dv√§ndig information f√∂r erbjudandet, inklusive l√•nebelopp, r√§nta, l√∂ptid och villkor, √§r tillg√§nglig</li>
        <li><strong>K√∂pekontrakt kan vara bed√∂mt eller beh√∂ver bed√∂mas:</strong> Systemet kontrollerar om k√∂pekontrakt redan √§r bed√∂mt eller om det beh√∂ver laddas upp och bed√∂mas</li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>Processteg - Output</summary>
        <div class="section-content">
      <p>N√§r Offer preparation-processen √§r slutf√∂rd har f√∂ljande resultat uppn√•tts:</p>
      <ul>
        <li><strong>Erbjudandet √§r presenterat till kunden:</strong> Ett komplett l√•neerbjudande har presenterats till kunden via "Decide on offer" user task, inklusive l√•nebelopp, r√§nta, l√∂ptid och villkor</li>
        <li><strong>K√∂pekontrakt √§r bed√∂mt (om till√§mpligt):</strong> Om k√∂pekontrakt beh√∂vde laddas upp, har det bed√∂mts via "Documentation assessment" call activity</li>
        <li><strong>Processen avslutas normalt:</strong> Om kunden accepterar erbjudandet (med validering av l√•nebelopp, kontonummer, datum), avslutas processen normalt och huvudprocessen forts√§tter med n√§sta steg (Document Generation)</li>
        <li><strong>Felhantering vid avvisning:</strong> Om kunden avvisar erbjudandet via "Decision" gateway "Decline offer", avslutas processen med "Offer declined" end event (event-offer-rejected) som signalerar till huvudprocessen att erbjudandet har avvisats</li>
        <li><strong>Felhantering vid timeout:</strong> Om erbjudandet l√∂per ut via timer event (Event_017jq28) p√• "Decide on offer" user task, avslutas processen med "Offer expired" end event (finansieringsbevis-terminate-end) som signalerar till huvudprocessen att erbjudandet har l√∂pt ut</li>
        <li><strong>Felhantering vid kreditbeslut:</strong> Om ytterligare kreditbeslut avvisas via "Approved?" gateway "No" efter att kunden beg√§rt √§ndringar, avslutas processen med "Credit decision rejected" end event (Event_0h20g8l) som signalerar till huvudprocessen att kreditbeslut har avvisats</li>
        <li><strong>Loop-mekanismer:</strong> Om kunden beg√§r √§ndringar via "Decision" gateway "Request changes", loopar processen tillbaka till "Perform advanced underwriting" user task f√∂r att hantera √§ndringar</li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>Omfattning</summary>
        <div class="section-content">
      <p>Offer preparation-processen omfattar f√∂ljande huvudsteg och aktiviteter:</p>
      
      <h3>1. K√∂pekontrakt-bed√∂mning</h3>
      <ul>
        <li><strong>Sales contract assessed? (gateway):</strong> En beslutspunkt avg√∂r om k√∂pekontrakt redan √§r bed√∂mt:
          <ul>
            <li><strong>Yes:</strong> Processen hoppar √∂ver kontraktuppladdning och g√•r direkt till erbjudandepresentation</li>
            <li><strong>No:</strong> Processen g√•r till kontraktuppladdning</li>
          </ul>
        </li>
        <li><strong>Sales contract uploaded? (gateway):</strong> En beslutspunkt avg√∂r om k√∂pekontrakt √§r uppladdat:
          <ul>
            <li><strong>Yes:</strong> Processen g√•r till dokumentationsbed√∂mning</li>
            <li><strong>No:</strong> Processen g√•r till "Upload sales contract" user task</li>
          </ul>
        </li>
        <li><strong>Upload sales contract (user task):</strong> Stakeholder laddar upp k√∂pekontrakt. P√• denna task kan "Request changes" boundary event (sales-contract-request-changes) triggas f√∂r att beg√§ra √§ndringar, vilket triggar "Perform advanced underwriting" user task och "Credit decision" call activity f√∂r k√∂pekontrakt</li>
        <li><strong>Documentation assessment (call activity):</strong> Uppladdat k√∂pekontrakt bed√∂ms via "Documentation assessment" call activity. P√• denna call activity kan "Documentation incomplete" boundary event triggas om dokumentation √§r ofullst√§ndig, vilket loopar tillbaka till kontraktuppladdning</li>
      </ul>

      <h3>2. Erbjudandepresentation</h3>
      <ul>
        <li><strong>Decide on offer (user task):</strong> Kunden fattar beslut om erbjudandet. Kunden kan acceptera erbjudandet (med validering av l√•nebelopp, kontonummer, datum), avvisa erbjudandet, eller beg√§ra √§ndringar. P√• denna task kan timer event (Event_017jq28) triggas om erbjudandet l√∂per ut</li>
        <li><strong>Decision (gateway):</strong> En beslutspunkt avg√∂r kundens beslut:
          <ul>
            <li><strong>Accept offer:</strong> Processen avslutas normalt och huvudprocessen forts√§tter med Document Generation</li>
            <li><strong>Decline offer:</strong> Processen avslutas med "Offer declined" end event</li>
            <li><strong>Request changes:</strong> Processen g√•r till avancerad underwriting f√∂r att hantera √§ndringar</li>
          </ul>
        </li>
      </ul>

      <h3>3. Avancerad underwriting och kreditbeslut (f√∂r √§ndringar)</h3>
      <ul>
        <li><strong>Perform advanced underwriting (user task):</strong> Caseworker utf√∂r avancerad underwriting n√§r kunden beg√§r √§ndringar. Detta kan ocks√• triggas av caseworker via "Request changes" boundary event p√• "Upload sales contract" user task</li>
        <li><strong>Credit decision (call activity):</strong> Ytterligare kreditbeslut genomf√∂rs via "Credit decision" call activity f√∂r att bed√∂ma om √§ndringar kan godk√§nnas</li>
        <li><strong>Approved? (gateway):</strong> En beslutspunkt avg√∂r om kreditbeslut √§r godk√§nt:
          <ul>
            <li><strong>Yes:</strong> Processen forts√§tter till erbjudandepresentation med uppdaterat erbjudande</li>
            <li><strong>No:</strong> Processen avslutas med "Credit decision rejected" end event</li>
          </ul>
        </li>
      </ul>

      <h3>4. K√∂pekontrakt-specifik underwriting (f√∂r √§ndringar vid kontraktuppladdning)</h3>
      <ul>
        <li><strong>Perform advanced underwriting (user task, f√∂r k√∂pekontrakt):</strong> Om "Request changes" boundary event triggas p√• "Upload sales contract" user task, utf√∂rs avancerad underwriting specifikt f√∂r k√∂pekontrakt</li>
        <li><strong>Credit decision (call activity, f√∂r k√∂pekontrakt):</strong> Ytterligare kreditbeslut genomf√∂rs specifikt f√∂r k√∂pekontrakt via "Credit decision" call activity</li>
        <li><strong>End event (Event_1c99mw4):</strong> Processen avslutas n√§r k√∂pekontrakt-specifik kreditbeslut √§r slutf√∂rt</li>
      </ul>

      <h3>5. Loop-mekanismer</h3>
      <ul>
        <li><strong>Dokumentation ofullst√§ndig:</strong> Om "Documentation incomplete" boundary event triggas p√• "Documentation assessment" call activity, loopar processen tillbaka till kontraktuppladdning via Gateway_18jx4nb</li>
        <li><strong>Kund beg√§r √§ndringar:</strong> Om kunden beg√§r √§ndringar via "Decision" gateway "Request changes", loopar processen tillbaka till "Perform advanced underwriting" user task f√∂r att hantera √§ndringar</li>
      </ul>

      <h3>6. Felhantering</h3>
      <ul>
        <li><strong>Offer declined (end event):</strong> Om kunden avvisar erbjudandet via "Decision" gateway "Decline offer", avslutas processen med "Offer declined" end event (event-offer-rejected) med escalation code "event-offer-rejected"</li>
        <li><strong>Offer expired (end event):</strong> Om timer event (Event_017jq28) triggas p√• "Decide on offer" user task, avslutas processen med "Offer expired" end event (finansieringsbevis-terminate-end) med escalation code "finansieringsbevis-terminate-end"</li>
        <li><strong>Credit decision rejected (end event):</strong> Om ytterligare kreditbeslut avvisas via "Approved?" gateway "No", avslutas processen med "Credit decision rejected" end event (Event_0h20g8l) med escalation code "credit-decision-rejected"</li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>Avgr√§nsning</summary>
        <div class="section-content">
<ul>
        <li>Credit Decision (huvudprocess) ing√•r inte - den sker tidigare i huvudprocessen</li>
        <li>Document Generation ing√•r inte - den sker efter Offer n√§r erbjudandet √§r accepterat</li>
        <li>Signing ing√•r inte - den sker efter Document Generation</li>
        <li>Disbursement ing√•r inte - den sker efter Signing</li>
        <li>Application-processen ing√•r inte - den sker tidigare i huvudprocessen</li>
        <li>KYC-processen ing√•r inte - den sker tidigare i huvudprocessen</li>
        <li>F√∂rskottsfl√∂det (event-trigger-advance) hanteras i huvudprocessen, inte i Offer-processen</li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>Beroenden</summary>
        <div class="section-content">
<ul>
        <li><strong>Mortgage huvudprocess:</strong> Offer anropas fr√•n mortgage.bpmn i huvudfl√∂det n√§r kreditbeslut √§r godk√§nt och erbjudande ska presenteras</li>
        <li><strong>Credit Decision (huvudprocess):</strong> Credit Decision m√•ste vara slutf√∂rd och godk√§nd innan Offer startar</li>
        <li><strong>Credit Decision (subprocess):</strong> Ytterligare kreditbeslut inom Offer-processen (anv√§nder samma BPMN-fil som huvudprocessens Credit Decision)</li>
        <li><strong>Caseworker:</strong> Utf√∂r avancerad underwriting n√§r kunden beg√§r √§ndringar</li>
        <li><strong>Customer/Stakeholder:</strong> Fattar beslut om erbjudandet (acceptera, avvisa, eller beg√§ra √§ndringar), validerar l√•nebelopp, kontonummer, datum vid acceptans</li>
        <li><strong>Document Generation:</strong> Efter accepterat erbjudande g√•r processen vidare till Document Generation via event-loan-ready</li>
        <li><strong>Felhantering:</strong> Processen kan avvisas, trigga timeout, eller loopa f√∂r √§ndringar</li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>BPMN - Process</summary>
        <div class="section-content">
      <p><a href="#/bpmn/mortgage-se-offer.bpmn">Visa BPMN-processen f√∂r Offer preparation</a></p>
      
      <h3>Processfl√∂de - Steg f√∂r steg</h3>
      <ol>
        <li><strong>Start:</strong> Processen startar n√§r Offer anropas fr√•n Mortgage huvudprocessen via "Offer preparation" call activity n√§r kreditbeslut √§r godk√§nt</li>
        <li><strong>Sales contract assessed? (gateway):</strong> En beslutspunkt avg√∂r om k√∂pekontrakt redan √§r bed√∂mt:
          <ul>
            <li><strong>Yes:</strong> Processen hoppar √∂ver kontraktuppladdning och g√•r direkt till erbjudandepresentation via Gateway_0m9hox9</li>
            <li><strong>No:</strong> Processen g√•r till kontraktuppladdning via Gateway_18jx4nb</li>
          </ul>
        </li>
        <li><strong>Sales contract uploaded? (gateway, om kontrakt inte √§r bed√∂mt):</strong> En beslutspunkt avg√∂r om k√∂pekontrakt √§r uppladdat. Om "No", aktiveras "Upload sales contract" user task. P√• denna task kan "Request changes" boundary event triggas f√∂r att beg√§ra √§ndringar</li>
        <li><strong>Documentation assessment (call activity, om kontrakt laddats upp):</strong> Uppladdat k√∂pekontrakt bed√∂ms. Om dokumentation √§r ofullst√§ndig, loopar processen tillbaka</li>
        <li><strong>Decide on offer (user task):</strong> Kunden fattar beslut om erbjudandet. P√• denna task kan timer event triggas om erbjudandet l√∂per ut</li>
        <li><strong>Decision (gateway):</strong> En beslutspunkt avg√∂r kundens beslut:
          <ul>
            <li><strong>Accept offer:</strong> Processen avslutas normalt</li>
            <li><strong>Decline offer:</strong> Processen avslutas med "Offer declined" end event</li>
            <li><strong>Request changes:</strong> Processen g√•r till "Perform advanced underwriting" user task</li>
          </ul>
        </li>
        <li><strong>Perform advanced underwriting (user task, om √§ndringar beg√§rs):</strong> Caseworker utf√∂r avancerad underwriting</li>
        <li><strong>Credit decision (call activity, om √§ndringar beg√§rs):</strong> Ytterligare kreditbeslut genomf√∂rs</li>
        <li><strong>Approved? (gateway, om √§ndringar beg√§rs):</strong> En beslutspunkt avg√∂r om kreditbeslut √§r godk√§nt. Om "No", avslutas processen med error event</li>
        <li><strong>Avslut:</strong> N√§r kunden accepterar erbjudandet, avslutas processen normalt och huvudprocessen forts√§tter med Document Generation</li>
      </ol>
      
      <h3>Viktiga beslutspunkter</h3>
      <ul>
        <li><strong>Sales contract assessed? (gateway):</strong> Avg√∂r om k√∂pekontrakt redan √§r bed√∂mt. Om "No", kr√§vs kontraktuppladdning</li>
        <li><strong>Sales contract uploaded? (gateway):</strong> Avg√∂r om k√∂pekontrakt √§r uppladdat. Om "No", aktiveras upload-task</li>
        <li><strong>Decision (gateway):</strong> Avg√∂r kundens beslut om erbjudandet. Kan resultera i acceptans, avvisning, eller beg√§ran om √§ndringar</li>
        <li><strong>Approved? (gateway):</strong> Avg√∂r om ytterligare kreditbeslut √§r godk√§nt efter √§ndringar. Om "No", avslutas processen med error event</li>
      </ul>
      
      <h3>Loop-mekanismer</h3>
      <ul>
        <li><strong>Dokumentation ofullst√§ndig:</strong> Om "Documentation incomplete" boundary event triggas, loopar processen tillbaka till kontraktuppladdning</li>
        <li><strong>Kund beg√§r √§ndringar:</strong> Om kunden beg√§r √§ndringar, loopar processen tillbaka till "Perform advanced underwriting" user task f√∂r att hantera √§ndringar</li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>Testgenerering</summary>
        <div class="section-content">
<p class="muted">Information f√∂r att generera automatiserade tester. Delar kan auto-genereras fr√•n processbeskrivningen, men kompletteras manuellt med implementation-specifik information (routes, locators, testdata).</p>

      <h3>Testscenarier</h3>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Namn</th>
            <th>Typ</th>
            <th>Persona</th>
            <th>Risk Level</th>
            <th>Assertion Type</th>
            <th>Outcome</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          
      <tr>
        <td><strong>S1</strong></td>
        <td>Normalfl√∂de ‚Äì k√∂pekontrakt redan bed√∂mt, erbjudande accepterat</td>
        <td>Happy</td>
        <td>customer</td>
        <td>P0</td>
        <td>functional</td>
        <td><strong>Given:</strong> K√∂pekontrakt √§r redan bed√∂mt. Erbjudande √§r redo. Testdata: offer-contract-assessed-happy. <strong>When:</strong> "Sales contract assessed?" gateway (sales-contract-assessed) = Yes. Processen hoppar √∂ver kontraktuppladdning. "Decide on offer" user task (decide-offer) aktiveras. Kunden accepterar erbjudandet (validerar l√•nebelopp, kontonummer, datum). <strong>Then:</strong> "Decision" gateway (offer-decision) = "Accept offer". Processen avslutas normalt (process-end-event). G√•r vidare till Document Generation.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S2</strong></td>
        <td>K√∂pekontrakt beh√∂ver laddas upp och bed√∂mas</td>
        <td>Happy</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td><strong>Given:</strong> K√∂pekontrakt √§r inte bed√∂mt. Testdata: offer-upload-contract. <strong>When:</strong> "Sales contract assessed?" gateway (sales-contract-assessed) = No. "Sales contract uploaded?" gateway (sales-contract-uploaded) = No. "Upload sales contract" user task (upload-sales-contract) aktiveras. Kund laddar upp kontrakt. "Sales contract uploaded?" = Yes. Documentation assessment (documentation-assessment) bed√∂mer kontrakt. <strong>Then:</strong> Processen forts√§tter till "Decide on offer" user task.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S3</strong></td>
        <td>Dokumentation ofullst√§ndig ‚Äì loop tillbaka</td>
        <td>Edge</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td><strong>Given:</strong> K√∂pekontrakt laddas upp men √§r ofullst√§ndigt. Testdata: offer-documentation-incomplete. <strong>When:</strong> Documentation assessment (documentation-assessment) bed√∂mer kontrakt. "Documentation incomplete" boundary event (documentation-incomplete) triggas. <strong>Then:</strong> Processen loopar tillbaka till kontraktuppladdning (Gateway_18jx4nb ‚Üí sales-contract-uploaded). Kund kan ladda upp kompletterande dokumentation.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S4</strong></td>
        <td>"Request changes" boundary event p√• upload-sales-contract</td>
        <td>Edge</td>
        <td>advisor</td>
        <td>P1</td>
        <td>functional</td>
        <td><strong>Given:</strong> K√∂pekontrakt laddas upp. Caseworker beg√§r √§ndringar. Testdata: offer-sales-contract-request-changes. <strong>When:</strong> "Request changes" boundary event (sales-contract-request-changes) triggas p√• upload-sales-contract user task. <strong>Then:</strong> "Perform advanced underwriting" user task (sales-contract-advanced-underwriting) aktiveras. "Credit decision" call activity (sales-contract-credit-decision) genomf√∂rs. Processen avslutas (Event_1c99mw4).</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S5</strong></td>
        <td>Kund beg√§r √§ndringar ‚Äì erbjudande accepterat efter underwriting</td>
        <td>Happy</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td><strong>Given:</strong> Erbjudande presenteras. Kund beg√§r √§ndringar. Testdata: offer-request-changes-approved. <strong>When:</strong> "Decision" gateway (offer-decision) = "Request changes". "Perform advanced underwriting" user task (advanced-underwriting) aktiveras. "Credit decision" call activity (credit-decision) genomf√∂rs. "Approved?" gateway (credit-decision-approved) = Yes. <strong>Then:</strong> Processen loopar tillbaka till "Decide on offer" (Gateway_0hrcun3 ‚Üí decide-offer). Kunden accepterar nytt erbjudande. Processen avslutas normalt.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S6</strong></td>
        <td>Kreditbeslut avvisas efter √§ndringar</td>
        <td>Error</td>
        <td>system</td>
        <td>P0</td>
        <td>functional</td>
        <td><strong>Given:</strong> Kund beg√§r √§ndringar. Kreditbeslut avvisas. Testdata: offer-credit-decision-rejected. <strong>When:</strong> "Decision" gateway = "Request changes". Advanced underwriting och credit decision genomf√∂rs. "Approved?" gateway (credit-decision-approved) = No. <strong>Then:</strong> "credit-decision-rejected" escalation event (Event_0h20g8l) triggas. Processen avslutas med "Credit decision rejected" end event. Huvudprocessen avbryts.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S7</strong></td>
        <td>Erbjudande avvisat av kund</td>
        <td>Error</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td><strong>Given:</strong> Erbjudande presenteras. Kund avvisar. Testdata: offer-declined. <strong>When:</strong> "Decision" gateway (offer-decision) = "Decline offer". <strong>Then:</strong> "event-offer-rejected" escalation event (event-offer-rejected) triggas. Processen avslutas med "Offer declined" end event. Huvudprocessen avbryts.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S8</strong></td>
        <td>Timeout ‚Äì erbjudandet l√∂per ut</td>
        <td>Error</td>
        <td>system</td>
        <td>P1</td>
        <td>functional</td>
        <td><strong>Given:</strong> Erbjudande presenteras. Kund svarar inte inom timeout-period. Testdata: offer-timeout. <strong>When:</strong> Timer event (Event_017jq28) triggas p√• decide-offer user task. <strong>Then:</strong> "finansieringsbevis-terminate-end" escalation event (finansieringsbevis-terminate-end) triggas. Processen avslutas med "Offer expired" end event. Huvudprocessen avbryts.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S9</strong></td>
        <td>Validering misslyckas vid acceptans</td>
        <td>Edge</td>
        <td>customer</td>
        <td>P2</td>
        <td>functional</td>
        <td><strong>Given:</strong> Kund f√∂rs√∂ker acceptera erbjudandet. Validering misslyckas. Testdata: offer-validation-failed. <strong>When:</strong> Kunden accepterar erbjudandet men validering misslyckas (ogiltigt kontonummer, felaktigt l√•nebelopp, eller ogiltigt datum). <strong>Then:</strong> Systemet visar felmeddelande. Kunden kan korrigera informationen. Processen forts√§tter p√• decide-offer user task tills validering lyckas.</td>
        <td>‚úÖ Planerad</td>
      </tr>
    
        </tbody>
      </table>
    
        </tbody>
      </table>

      <h3>UI Flow per Scenario</h3>
      <p class="muted">Detaljerade steg f√∂r varje scenario. Expandera f√∂r att se UI Flow.</p>
      
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S1: Normalfl√∂de ‚Äì komplett process</strong> (Klicka f√∂r att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1</td>
          <td>decide-on-offer</td>
          <td>navigate</td>
          <td>-</td>
          <td>-</td>
          <td>Navigera till decide on offer</td>
        </tr>
      
        <tr>
          <td>2</td>
          <td>decide-on-offer</td>
          <td>fill</td>
          <td>[TODO: L√§gg till locator f√∂r f√∂rsta f√§ltet]</td>
          <td>[TODO: Definiera testdata]</td>
          <td>Fyll i information f√∂r decide on offer</td>
        </tr>
      
        <tr>
          <td>3</td>
          <td>decide-on-offer</td>
          <td>click</td>
          <td>[TODO: L√§gg till locator f√∂r submit-knapp]</td>
          <td>-</td>
          <td>Skicka/Submit</td>
        </tr>
      
        <tr>
          <td>4</td>
          <td>decide-on-offer-confirmation</td>
          <td>verify</td>
          <td>[TODO: L√§gg till locator f√∂r bekr√§ftelsemeddelande]</td>
          <td>-</td>
          <td>Verifiera bekr√§ftelse</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S2: Om erbjudandet √§r avvisat: "event-offer-rejecte...</strong> (Klicka f√∂r att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1</td>
          <td>decide-on-offer</td>
          <td>navigate</td>
          <td>-</td>
          <td>-</td>
          <td>Navigera till decide on offer</td>
        </tr>
      
        <tr>
          <td>2</td>
          <td>decide-on-offer</td>
          <td>fill</td>
          <td>[TODO: L√§gg till locator f√∂r f√§lt]</td>
          <td>[TODO: Definiera testdata som orsakar fel]</td>
          <td>Fyll i information som orsakar fel</td>
        </tr>
      
        <tr>
          <td>3</td>
          <td>decide-on-offer</td>
          <td>verify</td>
          <td>[TODO: L√§gg till locator f√∂r felmeddelande]</td>
          <td>-</td>
          <td>Verifiera att felmeddelande visas</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S3: Om kreditbeslut avvisas: "Credit decision rejec...</strong> (Klicka f√∂r att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1</td>
          <td>decide-on-offer</td>
          <td>navigate</td>
          <td>-</td>
          <td>-</td>
          <td>Navigera till decide on offer</td>
        </tr>
      
        <tr>
          <td>2</td>
          <td>decide-on-offer</td>
          <td>fill</td>
          <td>[TODO: L√§gg till locator f√∂r f√§lt]</td>
          <td>[TODO: Definiera testdata som orsakar fel]</td>
          <td>Fyll i information som orsakar fel</td>
        </tr>
      
        <tr>
          <td>3</td>
          <td>decide-on-offer</td>
          <td>verify</td>
          <td>[TODO: L√§gg till locator f√∂r felmeddelande]</td>
          <td>-</td>
          <td>Verifiera att felmeddelande visas</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    

      <h3>Testdata-referenser</h3>
      <p class="muted">Testdata-profilerna som anv√§nds i scenarion. Definiera faktiska testdata i separat testdata-katalog.</p>
      <ul>
        
      <li><strong>[TODO: data-profile-id]</strong>: [TODO: Definiera testdata f√∂r denna process]</li>
    
      </ul>

      <h3>Implementation Mapping</h3>
      <p class="muted">Mappning mellan BPMN-aktiviteter och faktisk implementation (routes, endpoints, locators).</p>
      <table>
        <thead>
          <tr>
            <th>BPMN Aktivitet</th>
            <th>Type</th>
            <th>Route/Endpoint</th>
            <th>Method</th>
            <th>Base URL</th>
            <th>Kommentar</th>
          </tr>
        </thead>
        <tbody>
          
      <tr>
        <td>Start event</td>
        <td>Both</td>
        <td>[TODO: L√§gg till route, t.ex. /start-event]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>Processen startar n√§r Offer call activity anropas</td>
      </tr>
    
      <tr>
        <td>Gateway (initial routing)</td>
        <td>Both</td>
        <td>[TODO: L√§gg till route, t.ex. /gateway-(initial-routing)]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>Avg√∂r om processen g√•r direkt till beslutsfattande eller via avancerad underw...</td>
      </tr>
    
      <tr>
        <td>Decide on offer</td>
        <td>UI</td>
        <td>[TODO: L√§gg till route, t.ex. /decide-on-offer]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>User task (Stakeholder lane) d√§r kunden fattar beslut om erbjudandet (accepte...</td>
      </tr>
    
      <tr>
        <td>Offer decision gateway</td>
        <td>Both</td>
        <td>[TODO: L√§gg till route, t.ex. /offer-decision-gateway]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>Avg√∂r om kunden accepterar, avvisar, eller beg√§r √§ndringar</td>
      </tr>
    
      <tr>
        <td>Perform advanced underwriting</td>
        <td>UI</td>
        <td>[TODO: L√§gg till route, t.ex. /perform-advanced-underwriting]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>User task (Caseworker lane) som utf√∂rs n√§r kunden beg√§r √§ndringar (kan trigga...</td>
      </tr>
    
      <tr>
        <td>Credit decision (call activity)</td>
        <td>Both</td>
        <td>[TODO: L√§gg till route, t.ex. /credit-decision-(call-activity)]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>Ytterligare kreditbeslut inom Offer-processen (anv√§nder samma BPMN-fil som hu...</td>
      </tr>
    
      <tr>
        <td>Credit decision approved gateway</td>
        <td>Both</td>
        <td>[TODO: L√§gg till route, t.ex. /credit-decision-approved-gateway]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>Avg√∂r om kreditbeslut √§r godk√§nt - om nej, avvisas med "Credit decision rejec...</td>
      </tr>
    
      <tr>
        <td>Timer event</td>
        <td>Both</td>
        <td>[TODO: L√§gg till route, t.ex. /timer-event]</td>
        <td>-</td>
        <td>[TODO: L√§gg till base URL f√∂r milj√∂n]</td>
        <td>P√• "Decide on offer", kan trigga timeout om erbjudandet l√∂per ut</td>
      </tr>
    
        </tbody>
      </table>
        </div>
      </details>
    </section>
    <section class="doc-section">
      <details>
        <summary>Effekt</summary>
        <div class="section-content">
<p class="muted">F√∂rv√§ntad aff√§rseffekt som uppn√•s med feature goalet.</p>
      
      <h3>Strukturerad erbjudandepresentation och beslutsfattande</h3>
      <p>Genom tydlig strukturering av erbjudandepresentation via "Decide on offer" user task och "Decision" gateway kan kunder enkelt acceptera, avvisa eller beg√§ra √§ndringar i erbjudandet. Validering av l√•nebelopp, kontonummer och datum vid acceptans s√§kerst√§ller att endast korrekta erbjudanden accepteras. Detta kan minska antalet felaktiga acceptanser med upp till 40-50% och f√∂rb√§ttra kundupplevelsen.</p>
      
      <h3>Flexibel hantering av √§ndringar</h3>
      <p>Genom loop-mekanismer kan kunder beg√§ra √§ndringar i erbjudandet utan att processen beh√∂ver startas om. N√§r kunden beg√§r √§ndringar via "Decision" gateway "Request changes", loopar processen tillbaka till "Perform advanced underwriting" user task och "Credit decision" call activity f√∂r att hantera √§ndringar. Detta kan minska antalet avbrutna processer med upp till 30-40% och f√∂rb√§ttra kundn√∂jdheten.</p>
      
      <h3>Automatiserad k√∂pekontrakt-bed√∂mning</h3>
      <p>Genom automatisk bed√∂mning av k√∂pekontrakt via "Documentation assessment" call activity kan systemet snabbt bed√∂ma om kontraktet uppfyller krav. Om dokumentation √§r ofullst√§ndig, loopar processen automatiskt tillbaka f√∂r att beg√§ra komplettering. Detta kan minska handl√§ggningstid med upp till 50-60% f√∂r k√∂pekontrakt j√§mf√∂rt med manuell process.</p>
      
      <h3>Proaktiv timeout-hantering</h3>
      <p>Timer event (Event_017jq28) p√• "Decide on offer" user task s√§kerst√§ller att erbjudanden som inte anv√§nds automatiskt avslutas via "Offer expired" end event. Detta f√∂rhindrar att inaktiva erbjudanden blockerar systemresurser och kan minska antalet "zombie"-erbjudanden med upp till 90-95%.</p>
      
      <h3>Flexibel underwriting f√∂r k√∂pekontrakt</h3>
      <p>Genom "Request changes" boundary event p√• "Upload sales contract" user task kan caseworker beg√§ra √§ndringar direkt vid kontraktuppladdning, vilket triggar k√∂pekontrakt-specifik underwriting och kreditbeslut. Detta kan minska antalet processavbrott med upp till 40-50% och f√∂rb√§ttra kommunikationen mellan parter.</p>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>User stories</summary>
        <div class="section-content">
<p class="muted">Relevanta och realistiska user stories som kan kopplas till feature goalet.</p>
      
      <h3>Kundperspektiv</h3>
      <ul>
        <li><strong>Som kund</strong> vill jag kunna fatta beslut om erbjudandet via "Decide on offer" user task (decide-offer) <strong>s√• att</strong> jag kan acceptera, avvisa eller beg√§ra √§ndringar i mitt l√•neerbjudande. <em>Acceptanskriterier: Efter start event (start-event), ska fl√∂den samlas ihop via "Sammanf√∂r fl√∂den" gateway (Gateway_0hrcun3) och "Decide on offer" user task (decide-offer) ska aktiveras f√∂r kund. Task ska visa tydlig information om erbjudandet (l√•nebelopp, r√§nta, l√∂ptid, villkor) och till√•ta kund att fatta beslut. Efter beslut, ska fl√∂det g√• till "Decision" gateway (offer-decision).</em></li>
        <li><strong>Som kund</strong> vill jag kunna acceptera erbjudandet via "Decision" gateway (offer-decision) "Accept offer" <strong>s√• att</strong> processen kan forts√§tta till Document Generation. <em>Acceptanskriterier: N√§r kund v√§ljer "Accept offer" via "Decision" gateway (offer-decision), ska systemet validera l√•nebelopp, kontonummer och datum. Om validering lyckas, ska fl√∂det g√• till "Accept offer" fl√∂de (offer-decision-accept) och processen avslutas normalt via end event (process-end-event). Om validering misslyckas, ska kunden informeras och kunna korrigera informationen p√• "Decide on offer" user task.</em></li>
        <li><strong>Som kund</strong> vill jag kunna avvisa erbjudandet via "Decision" gateway (offer-decision) "Decline offer" <strong>s√• att</strong> processen avslutas korrekt n√§r jag inte vill acceptera erbjudandet. <em>Acceptanskriterier: N√§r kund v√§ljer "Decline offer" via "Decision" gateway (offer-decision), ska fl√∂det g√• till "Decline offer" fl√∂de (offer-decision-decline) och "Offer declined" end event (event-offer-rejected) ska triggas med escalation code "event-offer-rejected" (Escalation_335oqci). End event ska signalera till huvudprocessen att erbjudandet har avvisats.</em></li>
        <li><strong>Som kund</strong> vill jag kunna beg√§ra √§ndringar i erbjudandet via "Decision" gateway (offer-decision) "Request changes" <strong>s√• att</strong> jag kan justera villkor utan att beh√∂va starta en ny ans√∂kan. <em>Acceptanskriterier: N√§r kund v√§ljer "Request changes" via "Decision" gateway (offer-decision), ska fl√∂det g√• till "Request changes" fl√∂de (offer-decision-request-changes) och "Perform advanced underwriting" user task (advanced-underwriting) ska aktiveras f√∂r caseworker. Efter underwriting, ska "Credit decision" call activity (credit-decision) genomf√∂ras och "Approved?" gateway (credit-decision-approved) avg√∂ra om √§ndringar kan godk√§nnas. Om godk√§nt, ska processen loopa tillbaka till "Sammanf√∂r fl√∂den" gateway (Gateway_0hrcun3) via "Yes" fl√∂de (credit-decision-approved-yes) och sedan till "Decide on offer" user task med uppdaterat erbjudande.</em></li>
      </ul>
      
      <h3>Caseworker-perspektiv</h3>
      <ul>
        <li><strong>Som caseworker</strong> vill jag kunna utf√∂ra avancerad underwriting via "Perform advanced underwriting" user task (advanced-underwriting) n√§r kund beg√§r √§ndringar <strong>s√• att</strong> jag kan bed√∂ma om √§ndringar kan godk√§nnas. <em>Acceptanskriterier: N√§r kund v√§ljer "Request changes" via "Decision" gateway (offer-decision), ska "Perform advanced underwriting" user task (advanced-underwriting) aktiveras f√∂r caseworker. Task ska visa tydlig information om beg√§rda √§ndringar och till√•ta caseworker att bed√∂ma om √§ndringar kan godk√§nnas. Efter underwriting, ska fl√∂det g√• till "Credit decision" call activity (credit-decision).</em></li>
        <li><strong>Som caseworker</strong> vill jag att "Credit decision" call activity (credit-decision) automatiskt genomf√∂rs efter avancerad underwriting <strong>s√• att</strong> systemet kan bed√∂ma om √§ndringar kan godk√§nnas. <em>Acceptanskriterier: Efter "Perform advanced underwriting" user task (advanced-underwriting), ska "Credit decision" call activity (credit-decision) automatiskt anropas f√∂r att bed√∂ma om √§ndringar kan godk√§nnas. Efter kreditbeslut, ska fl√∂det g√• till "Approved?" gateway (credit-decision-approved).</em></li>
        <li><strong>Som caseworker</strong> vill jag att "Approved?" gateway (credit-decision-approved) avg√∂r om √§ndringar kan godk√§nnas <strong>s√• att</strong> processen kan forts√§tta med uppdaterat erbjudande eller avvisas. <em>Acceptanskriterier: Efter "Credit decision" call activity (credit-decision) har genomf√∂rt kreditbeslut, ska "Approved?" gateway (credit-decision-approved) avg√∂ra om √§ndringar kan godk√§nnas. Om gateway returnerar "Yes", ska fl√∂det g√• till "Sammanf√∂r fl√∂den" gateway (Gateway_0hrcun3) via "Yes" fl√∂de (credit-decision-approved-yes) och sedan till "Decide on offer" user task med uppdaterat erbjudande. Om gateway returnerar "No", ska "Credit decision rejected" end event (Event_0h20g8l) triggas med escalation code "credit-decision-rejected" (Escalation_1o4rs8b).</em></li>
      </ul>
      
      <h3>Systemperspektiv</h3>
      <ul>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att processen startar via start event (start-event) <strong>s√• att</strong> Offer-processen kan initieras n√§r huvudprocessen anropar "offer" call activity. <em>Acceptanskriterier: Start event (start-event) ska triggas n√§r huvudprocessen anropar "offer" call activity n√§r kreditbeslut √§r godk√§nt. Efter start event, ska fl√∂det g√• till "Sammanf√∂r fl√∂den" gateway (Gateway_0hrcun3) via Flow_0lzkd3s.</em></li>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att "Sammanf√∂r fl√∂den" gateway (Gateway_0hrcun3) samlar ihop fl√∂den fr√•n b√•de start och loop <strong>s√• att</strong> processen kan hantera b√•de initial erbjudandepresentation och uppdaterat erbjudande efter √§ndringar. <em>Acceptanskriterier: "Sammanf√∂r fl√∂den" gateway (Gateway_0hrcun3) ska samla ihop fl√∂den fr√•n antingen start event (start-event) via Flow_0lzkd3s eller loop fr√•n "Approved?" gateway (credit-decision-approved) "Yes" via credit-decision-approved-yes. N√§r fl√∂den samlas ihop, ska "Decide on offer" user task (decide-offer) aktiveras via Flow_0g7258d.</em></li>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att "Decision" gateway (offer-decision) kan hantera tre olika beslut <strong>s√• att</strong> processen kan acceptera, avvisa eller beg√§ra √§ndringar. <em>Acceptanskriterier: Efter "Decide on offer" user task (decide-offer), ska "Decision" gateway (offer-decision) avg√∂ra kundens beslut. Gateway ska ha tre utg√•ngar: "Accept offer" (offer-decision-accept), "Decline offer" (offer-decision-decline), och "Request changes" (offer-decision-request-changes). Om "Accept offer", ska fl√∂det g√• till end event (process-end-event). Om "Decline offer", ska fl√∂det g√• till "Offer declined" end event (event-offer-rejected). Om "Request changes", ska fl√∂det g√• till "Perform advanced underwriting" user task (advanced-underwriting).</em></li>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att timer event (Event_017jq28) automatiskt avslutar erbjudanden som l√∂per ut <strong>s√• att</strong> inaktiva erbjudanden inte blockerar systemresurser. <em>Acceptanskriterier: P√• "Decide on offer" user task (decide-offer), ska timer event (Event_017jq28) triggas n√§r timeout-perioden har passerat. N√§r timer event triggas, ska fl√∂det g√• till "Offer expired" end event (finansieringsbevis-terminate-end) via Flow_1jo2wb1. End event ska trigga escalation event "finansieringsbevis-terminate-end" (Escalation_016l7ta) som signalerar till huvudprocessen att erbjudandet har l√∂pt ut.</em></li>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att processen avslutas normalt via end event (process-end-event) n√§r kund accepterar erbjudandet <strong>s√• att</strong> huvudprocessen kan forts√§tta med Document Generation. <em>Acceptanskriterier: N√§r kund v√§ljer "Accept offer" via "Decision" gateway (offer-decision) och validering lyckas, ska fl√∂det g√• till "Accept offer" fl√∂de (offer-decision-accept) och processen ska avslutas normalt via end event (process-end-event). Huvudprocessen ska forts√§tta med Document Generation n√§r processen avslutas.</em></li>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att "Offer declined" end event (event-offer-rejected) signaliserar att erbjudandet har avvisats <strong>s√• att</strong> huvudprocessen kan hantera avvisningen korrekt. <em>Acceptanskriterier: N√§r kund v√§ljer "Decline offer" via "Decision" gateway (offer-decision), ska fl√∂det g√• till "Decline offer" fl√∂de (offer-decision-decline) och "Offer declined" end event (event-offer-rejected) ska triggas med escalation code "event-offer-rejected" (Escalation_335oqci). End event ska signalera till huvudprocessen att erbjudandet har avvisats.</em></li>
        <li><strong>Som systemadministrat√∂r</strong> vill jag att "Credit decision rejected" end event (Event_0h20g8l) signaliserar att kreditbeslut har avvisats <strong>s√• att</strong> huvudprocessen kan hantera avvisningen korrekt. <em>Acceptanskriterier: N√§r "Approved?" gateway (credit-decision-approved) returnerar "No", ska fl√∂det g√• till "No" fl√∂de (credit-decision-approved-no) och "Credit decision rejected" end event (Event_0h20g8l) ska triggas med escalation code "credit-decision-rejected" (Escalation_1o4rs8b). End event ska signalera till huvudprocessen att kreditbeslut har avvisats.</em></li>
      </ul>
        </div>
      </details>
    </section>

    <section class="doc-section">
      <details>
        <summary>Acceptanskriterier</summary>
        <div class="section-content">
<p class="muted">Relevanta och realistiska acceptanskriterier som kan kopplas till feature goalet.</p>
      
      <h3>K√∂pekontrakt-bed√∂mning</h3>
      <ul>
        <li>"Sales contract assessed?" gateway ska korrekt identifiera om k√∂pekontrakt redan √§r bed√∂mt. Om "Yes", ska processen hoppa √∂ver kontraktuppladdning och g√• direkt till erbjudandepresentation via Gateway_0m9hox9</li>
        <li>"Sales contract uploaded?" gateway ska korrekt identifiera om k√∂pekontrakt √§r uppladdat. Om "No", ska "Upload sales contract" user task aktiveras f√∂r stakeholder</li>
        <li>"Request changes" boundary event (sales-contract-request-changes) ska kunna triggas p√• "Upload sales contract" user task f√∂r att beg√§ra √§ndringar, vilket triggar "Perform advanced underwriting" user task och "Credit decision" call activity f√∂r k√∂pekontrakt</li>
        <li>"Documentation assessment" call activity ska automatiskt bed√∂ma uppladdat k√∂pekontrakt</li>
        <li>"Documentation incomplete" boundary event ska kunna triggas p√• "Documentation assessment" call activity om dokumentation √§r ofullst√§ndig, vilket loopar processen tillbaka till kontraktuppladdning via Gateway_18jx4nb</li>
      </ul>
      
      <h3>Erbjudandepresentation och beslutsfattande</h3>
      <ul>
        <li>"Decide on offer" user task ska aktiveras f√∂r stakeholder n√§r k√∂pekontrakt √§r bed√∂mt (eller redan bed√∂mt) och kreditbeslut √§r godk√§nt</li>
        <li>Timer event (Event_017jq28) ska kunna triggas p√• "Decide on offer" user task om erbjudandet l√∂per ut, vilket avslutar processen med "Offer expired" end event (finansieringsbevis-terminate-end) med escalation code "finansieringsbevis-terminate-end"</li>
        <li>"Decision" gateway ska korrekt avg√∂ra kundens beslut om erbjudandet. Gateway ska ha tre utg√•ngar: "Accept offer", "Decline offer", och "Request changes"</li>
        <li>N√§r kunden accepterar erbjudandet via "Decision" gateway "Accept offer", ska systemet validera l√•nebelopp, kontonummer och datum. Om validering misslyckas, ska kunden informeras och kunna korrigera informationen</li>
        <li>Om kunden avvisar erbjudandet via "Decision" gateway "Decline offer", ska "Offer declined" end event (event-offer-rejected) triggas med escalation code "event-offer-rejected"</li>
      </ul>
      
      <h3>Avancerad underwriting och kreditbeslut (f√∂r √§ndringar)</h3>
      <ul>
        <li>Om kunden beg√§r √§ndringar via "Decision" gateway "Request changes", ska "Perform advanced underwriting" user task aktiveras f√∂r caseworker</li>
        <li>"Credit decision" call activity ska automatiskt anropas efter "Perform advanced underwriting" user task f√∂r att bed√∂ma om √§ndringar kan godk√§nnas</li>
        <li>"Approved?" gateway ska korrekt avg√∂ra om ytterligare kreditbeslut √§r godk√§nt. Om "Yes", ska processen forts√§tta till erbjudandepresentation med uppdaterat erbjudande via Gateway_0hrcun3</li>
        <li>Om "Approved?" gateway returnerar "No", ska "Credit decision rejected" end event (Event_0h20g8l) triggas med escalation code "credit-decision-rejected"</li>
      </ul>
      
      <h3>K√∂pekontrakt-specifik underwriting (f√∂r √§ndringar vid kontraktuppladdning)</h3>
      <ul>
        <li>Om "Request changes" boundary event triggas p√• "Upload sales contract" user task, ska "Perform advanced underwriting" user task (sales-contract-advanced-underwriting) aktiveras f√∂r caseworker</li>
        <li>"Credit decision" call activity (sales-contract-credit-decision) ska automatiskt anropas efter k√∂pekontrakt-specifik underwriting</li>
        <li>N√§r k√∂pekontrakt-specifik kreditbeslut √§r slutf√∂rt, ska processen avslutas med end event (Event_1c99mw4)</li>
      </ul>
      
      <h3>Loop-mekanismer</h3>
      <ul>
        <li>Om "Documentation incomplete" boundary event triggas, ska processen automatiskt loopa tillbaka till kontraktuppladdning via Gateway_18jx4nb</li>
        <li>Om kunden beg√§r √§ndringar via "Decision" gateway "Request changes", ska processen automatiskt loopa tillbaka till "Perform advanced underwriting" user task f√∂r att hantera √§ndringar</li>
      </ul>
      
      <h3>Felhantering</h3>
      <ul>
        <li>Om kunden avvisar erbjudandet via "Decision" gateway "Decline offer", ska "Offer declined" end event (event-offer-rejected) triggas med escalation code "event-offer-rejected", vilket signalerar till huvudprocessen att erbjudandet har avvisats</li>
        <li>Om timer event (Event_017jq28) triggas p√• "Decide on offer" user task, ska "Offer expired" end event (finansieringsbevis-terminate-end) triggas med escalation code "finansieringsbevis-terminate-end", vilket signalerar till huvudprocessen att erbjudandet har l√∂pt ut</li>
        <li>Om ytterligare kreditbeslut avvisas via "Approved?" gateway "No", ska "Credit decision rejected" end event (Event_0h20g8l) triggas med escalation code "credit-decision-rejected", vilket signalerar till huvudprocessen att kreditbeslut har avvisats</li>
        <li>Alla error events ska korrekt trigga motsvarande boundary events i huvudprocessen f√∂r att s√§kerst√§lla att hela processen avbryts n√§r erbjudandet avvisas eller l√∂per ut</li>
      </ul>
      
      <h3>Processvariabler och data</h3>
      <ul>
        <li>Alla processvariabler ska skickas med n√§r Offer anropas fr√•n huvudprocessen f√∂r att s√§kerst√§lla fullst√§ndig kontext</li>
        <li>K√∂pekontrakt som laddas upp via "Upload sales contract" user task ska korrekt sparas i systemet</li>
        <li>Resultat fr√•n "Documentation assessment" call activity ska korrekt sparas och anv√§ndas i efterf√∂ljande gateways</li>
        <li>Resultat fr√•n "Credit decision" call activities (b√•de f√∂r √§ndringar och f√∂r k√∂pekontrakt) ska korrekt sparas och anv√§ndas i efterf√∂ljande gateways</li>
        <li>Kundens beslut fr√•n "Decide on offer" user task ska korrekt sparas och anv√§ndas i "Decision" gateway</li>
        <li>Validerade data (l√•nebelopp, kontonummer, datum) vid acceptans ska korrekt sparas och vara tillg√§ngliga f√∂r huvudprocessen</li>
      </ul>

      <h3>Tekniska krav</h3>
      <ul>
        <li><strong>Timeout:</strong> User tasks ska ha timeout p√• 30 dagar f√∂r kundaktiviteter. Call activities och service tasks ska ha timeout p√• 60 sekunder. Timer events ska triggas korrekt</li>
        <li><strong>Retry:</strong> Call activities och service tasks ska ha automatisk retry med exponential backoff (max 3 f√∂rs√∂k) vid tekniska fel</li>
        <li><strong>Error codes:</strong> Systemet ska returnera specifika error codes: OFFER_REJECTED, OFFER_EXPIRED, OFFER_TIMEOUT, OFFER_SERVICE_ERROR</li>
        <li><strong>Logging:</strong> Alla erbjudanden, beslut, eskaleringar och timeout ska loggas med erbjudande-ID, anv√§ndar-ID, tidsst√§mplar och resultat f√∂r sp√•rbarhet</li>
      </ul>

      <h3>UI/UX-krav</h3>
      <ul>
        <li><strong>Kund-vyer:</strong> "Decide on offer" user task ska visa tydlig, strukturerad information om erbjudandet med separata sektioner f√∂r villkor, belopp och acceptans</li>
        <li><strong>Statusindikatorer:</strong> Systemet ska visa tydlig status f√∂r varje steg i processen med visuella indikatorer</li>
      </ul>

      <h3>Skalbarhet och prestanda</h3>
      <ul>
        <li><strong>Parallellisering:</strong> Systemet ska kunna hantera flera erbjudanden parallellt</li>
        <li><strong>Load balancing:</strong> Service tasks ska kunna hantera minst 30 erbjudanden per minut</li>
      </ul>

      <h3>S√§kerhet och compliance</h3>
      <ul>
        <li><strong>Dataskydd:</strong> All k√§nslig erbjudandeinformation ska krypteras i vila och under √∂verf√∂ring (TLS 1.3)</li>
        <li><strong>GDPR-efterlevnad:</strong> Alla erbjudanden ska inneh√•lla sp√•rbarhet f√∂r n√§r erbjudandet skapades, n√§r beslutet fattades och resultatet</li>
        <li><strong>Audit trail:</strong> Alla erbjudanden och beslut ska loggas f√∂r fullst√§ndig sp√•rbarhet</li>
      </ul>
        </div>
      </details>
    </section>
      </body>
</html>
