<!DOCTYPE html>
<html lang="sv">
<head>
  <meta name="x-generation-source" content="local-fallback" />
  <meta name="x-feature-goal-template-version" content="v2" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Application</title>
  <style>
    :root {
      color-scheme: light;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      --card-bg: #ffffff;
      --primary: #1d4ed8;
      --text-strong: #0f172a;
      --text-muted: #475569;
      --border: #e2e8f0;
      --accent: #dbeafe;
    }
    body {
      margin: 0;
      padding: 16px;
      background: #ffffff;
      color: var(--text-strong);
      line-height: 1.7;
    }
    .doc-shell {
      max-width: 960px;
      margin: 0 auto;
    }
    h1 {
      font-size: 1.5rem;
      margin: 0 0 24px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
    }
    h2 {
      color: var(--primary);
      margin: 24px 0 12px;
      font-size: 1.1rem;
    }
    p { margin: 0 0 12px; }
    ul { padding-left: 20px; margin: 0 0 12px; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 12px 0;
      background: var(--card-bg);
      border: 1px solid var(--border);
    }
    table th,
    table td {
      border-bottom: 1px solid var(--border);
      padding: 8px;
      text-align: left;
    }
    table th {
      background: var(--accent);
      color: var(--primary);
      font-weight: 600;
    }
    table tr:last-child td {
      border-bottom: none;
    }
    .muted { color: var(--text-muted); font-size: 0.9rem; }
    a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }
    a:hover { text-decoration: underline; }
    .doc-section {
      margin-bottom: 24px;
      padding: 16px;
      background: var(--card-bg);
      border: 1px solid var(--border);
    }
    .doc-section + .doc-section { margin-top: 16px; }
    .doc-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--accent);
      color: var(--primary);
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .llm-fallback-banner {
      padding: 8px 12px;
      margin-bottom: 16px;
      border-radius: 6px;
      background-color: #fefce8;
      color: #854d0e;
      border: 1px solid #fef9c3;
      font-size: 0.85rem;
    }
    .llm-fallback-badge {
      display: inline-block;
      padding: 4px 8px;
      margin-bottom: 12px;
      border-radius: 4px;
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
      font-size: 0.9rem;
      font-weight: 600;
    }
    .llm-fallback-details {
      font-size: 0.8rem;
      color: #4b5563;
      margin-bottom: 16px;
      white-space: pre-wrap;
    }
    .llm-fallback-local-note {
      font-size: 0.8rem;
      color: #2563eb;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <div class="doc-shell">
    
    
    
    <section class="doc-section">
      <h2>Beskrivning av FGoal</h2>
      <p>Application samlar in och validerar all nödvändig information för en bolåneansökan. Processen startar med intern datainsamling (hämtar befintlig kunddata och gör pre-screening), och fortsätter sedan parallellt med att samla in information om hushåll (ekonomi, inkomster, låneuppgifter) och stakeholders (personer och objekt/fastighet). När all data är insamlad och validerad, bekräftar kunden ansökan innan den går vidare till kreditevaluering.</p>
    </section>

    <section class="doc-section">
      <h2>Confluence länk</h2>
      <p><a href="https://confluence.sbab.se/spaces/PC/pages/276205652/Application+-+Internal+data+gathering+-+Inh%C3%A4mta+intern+data">https://confluence.sbab.se/spaces/PC/pages/276205652/Application+-+Internal+data+gathering+-+Inh%C3%A4mta+intern+data</a></p>
    </section>

    <section class="doc-section">
      <h2>Processteg - Input</h2>
      <ul>
        <li>Kreditansökan initieras i Mortgage huvudprocessen</li>
        <li>Grundläggande ansökningsdata (ansöknings-ID, kund-ID, ansökningstyp, önskat belopp, löptid, fastighetstyp)</li>
        <li>Processen startar när Application call activity anropas från mortgage.bpmn</li>
      </ul>
    </section>

    <section class="doc-section">
      <h2>Processteg - Output</h2>
      <ul>
        <li>Komplett ansökningsdata insamlad och validerad (stakeholders, hushåll, objekt/fastighet, intern data)</li>
        <li>Ansökan bekräftad av kunden via "Confirm application" user task</li>
        <li>Processen avslutas och ansökan går vidare till kreditevaluering i huvudprocessen</li>
        <li>Vid fel: Pre-screen rejected, Stakeholder rejected, eller Object rejected (error events)</li>
      </ul>
    </section>

    <section class="doc-section">
      <h2>Omfattning</h2>
      <ul>
        <li><strong>Internal data gathering:</strong> Hämtar befintlig kunddata från interna system (part, engagemang, kreditinformation) och gör pre-screening via DMN. Körs per part (multi-instance).</li>
        <li><strong>Household:</strong> Samlar in hushållsekonomi, personlig ekonomi, källa till eget kapital och låneuppgifter. Körs parallellt med stakeholders.</li>
        <li><strong>Stakeholders (subprocess):</strong> Samlar in information om alla involverade parter. Innehåller två call activities som körs sekventiellt per stakeholder:
          <ul>
            <li><strong>Stakeholder:</strong> Registrerar personlig information, samtycke till kreditupplysning, hämtar och utvärderar personlig information, bedömer stakeholder via DMN</li>
            <li><strong>Object:</strong> Hanterar fastighetsinformation (fastighetstyp, värdering, säkerhetsregistrering), utvärderar fastighet/bostadsrätt via DMN</li>
          </ul>
        </li>
        <li><strong>Confirm application:</strong> User task där kunden bekräftar att all information är korrekt innan ansökan går vidare</li>
        <li><strong>Felhantering:</strong> Pre-screen rejected (från internal-data-gathering), Stakeholder rejected, Object rejected (från stakeholders subprocess)</li>
      </ul>
    </section>

    <section class="doc-section">
      <h2>Avgränsning</h2>
      <ul>
        <li>Kreditevaluering ingår inte - den sker i huvudprocessen efter Application</li>
        <li>KYC-processen ingår inte - den sker i huvudprocessen efter Application</li>
        <li>Kreditbeslut ingår inte - det sker i huvudprocessen efter Application</li>
        <li>Dokumentgenerering ingår inte - den sker senare i huvudprocessen</li>
        <li>Signering och utbetalning ingår inte - de sker senare i huvudprocessen</li>
      </ul>
    </section>

    <section class="doc-section">
      <h2>Beroenden</h2>
      <ul>
        <li><strong>Mortgage huvudprocess:</strong> Application anropas från mortgage.bpmn som första steg i kreditprocessen</li>
        <li><strong>Internal data gathering:</strong> Subprocess som hämtar data från interna system (part, engagemang, kreditinformation) och gör pre-screening</li>
        <li><strong>Stakeholder subprocess:</strong> Hanterar information om alla involverade parter och deras fastigheter</li>
        <li><strong>Household subprocess:</strong> Samlar in hushållsekonomi och låneuppgifter</li>
        <li><strong>DMN-beslutsregler:</strong> Pre-screen Party, Assess Stakeholder, Evaluate Fastighet, Evaluate Bostadsrätt används för automatisk validering</li>
        <li><strong>Interna system:</strong> Partsystem, engagemangssystem, kreditupplysning för datainsamling</li>
        <li><strong>Kundportal:</strong> För att kunden ska kunna fylla i information och bekräfta ansökan</li>
      </ul>
    </section>

    <section class="doc-section">
      <h2>BPMN - Process</h2>
      <p><a href="#/bpmn/mortgage-se-application.bpmn">Visa BPMN-processen för Application</a></p>
      <p class="muted">Processen startar med Internal data gathering (multi-instance, per part), fortsätter med ett parallellt gateway som delar upp i Household (multi-instance) och Stakeholders (subprocess, multi-instance). Stakeholders subprocessen innehåller Stakeholder och Object call activities som körs sekventiellt. När båda parallella flöden är klara, går processen vidare till Confirm application user task innan den avslutas.</p>
    </section>

    <section class="doc-section">
      <h2>Testgenerering</h2>
      <p class="muted">Information för att generera automatiserade tester. Delar kan auto-genereras från processbeskrivningen, men kompletteras manuellt med implementation-specifik information (routes, locators, testdata).</p>

      <h3>Testscenarier</h3>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Namn</th>
            <th>Typ</th>
            <th>Persona</th>
            <th>Risk Level</th>
            <th>Assertion Type</th>
            <th>Outcome</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          
      <tr>
        <td><strong>S1</strong></td>
        <td>Normalflöde – komplett ansökan med en stakeholder</td>
        <td>Happy</td>
        <td>customer</td>
        <td>P0</td>
        <td>functional</td>
        <td>All data insamlad: intern data (pre-screen godkänd), hushåll, en stakeholder med objekt. Ansökan bekräftad och klar för kreditevaluering.</td>
        <td>✅ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S2</strong></td>
        <td>Normalflöde – ansökan med flera stakeholders (sambo/medlåntagare)</td>
        <td>Happy</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td>All data insamlad med flera stakeholders (huvudsökande + sambo/medlåntagare). Varje stakeholder har eget objekt. Alla pre-screen godkända.</td>
        <td>✅ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S3</strong></td>
        <td>Pre-screen rejected – kund uppfyller inte grundläggande krav</td>
        <td>Error</td>
        <td>customer</td>
        <td>P0</td>
        <td>functional</td>
        <td>Pre-screen DMN avvisar kunden (t.ex. för låg kreditvärdighet, ålder, anställningsstatus). Processen avslutas med error event "Pre-screening rejected".</td>
        <td>✅ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S4</strong></td>
        <td>Stakeholder rejected – en stakeholder uppfyller inte krav</td>
        <td>Error</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td>En stakeholder (t.ex. medlåntagare) avvisas av Assess Stakeholder DMN. Processen avslutas med error event "Stakeholder rejected".</td>
        <td>✅ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S5</strong></td>
        <td>Object rejected – fastighet/bostadsrätt uppfyller inte krav</td>
        <td>Error</td>
        <td>customer</td>
        <td>P1</td>
        <td>functional</td>
        <td>Fastighet/bostadsrätt avvisas av Evaluate Fastighet/Bostadsrätt DMN (t.ex. för hög LTV, dålig belägenhet). Processen avslutas med error event "Object rejected".</td>
        <td>✅ Planerad</td>
      </tr>
    
      <tr>
        <td><strong>S6</strong></td>
        <td>Komplettering behövs – ofullständig hushållsekonomi</td>
        <td>Edge</td>
        <td>customer</td>
        <td>P2</td>
        <td>functional</td>
        <td>Hushållsekonomi saknar viktig information (t.ex. källa till eget kapital). Systemet kräver komplettering innan ansökan kan bekräftas.</td>
        <td>✅ Planerad</td>
      </tr>
    
        </tbody>
      </table>

      <h3>UI Flow per Scenario</h3>
      <p class="muted">Detaljerade steg för varje scenario. Expandera för att se UI Flow.</p>
      
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S1: Normalflöde – komplett ansökan med en stakeholder</strong> (Klicka för att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1</td>
          <td>application-start</td>
          <td>navigate</td>
          <td>nav-application</td>
          <td>customer-standard</td>
          <td>Navigera till Application-processen från Mortgage huvudprocess</td>
        </tr>
      
        <tr>
          <td>2</td>
          <td>internal-data-gathering</td>
          <td>navigate</td>
          <td>nav-internal-data</td>
          <td>customer-standard</td>
          <td>Internal data gathering startar automatiskt (multi-instance per part). Vänta på att systemet hämtar data från interna system.</td>
        </tr>
      
        <tr>
          <td>3</td>
          <td>internal-data-gathering</td>
          <td>verify</td>
          <td>pre-screen-result-approved</td>
          <td>customer-standard</td>
          <td>Verifiera att Pre-screen Party DMN returnerar "APPROVED"</td>
        </tr>
      
        <tr>
          <td>4</td>
          <td>household</td>
          <td>navigate</td>
          <td>nav-household</td>
          <td>customer-standard</td>
          <td>Navigera till Household-formulär (körs parallellt med Stakeholders)</td>
        </tr>
      
        <tr>
          <td>5</td>
          <td>household</td>
          <td>fill</td>
          <td>input-household-economy</td>
          <td>customer-standard</td>
          <td>Fyll i hushållsekonomi (inkomster, utgifter, tillgångar)</td>
        </tr>
      
        <tr>
          <td>6</td>
          <td>household</td>
          <td>fill</td>
          <td>input-personal-economy</td>
          <td>customer-standard</td>
          <td>Fyll i personlig ekonomi (löner, andra inkomster)</td>
        </tr>
      
        <tr>
          <td>7</td>
          <td>household</td>
          <td>fill</td>
          <td>input-equity-source</td>
          <td>customer-standard</td>
          <td>Fyll i källa till eget kapital</td>
        </tr>
      
        <tr>
          <td>8</td>
          <td>household</td>
          <td>fill</td>
          <td>input-loan-details</td>
          <td>customer-standard</td>
          <td>Fyll i låneuppgifter (befintliga lån, krediter)</td>
        </tr>
      
        <tr>
          <td>9</td>
          <td>household</td>
          <td>click</td>
          <td>btn-submit-household</td>
          <td>customer-standard</td>
          <td>Skicka in Household-data</td>
        </tr>
      
        <tr>
          <td>10</td>
          <td>stakeholders</td>
          <td>navigate</td>
          <td>nav-stakeholders</td>
          <td>customer-standard</td>
          <td>Navigera till Stakeholders (körs parallellt med Household)</td>
        </tr>
      
        <tr>
          <td>11</td>
          <td>stakeholder</td>
          <td>navigate</td>
          <td>nav-stakeholder</td>
          <td>customer-standard</td>
          <td>Navigera till Stakeholder-formulär (första stakeholder = huvudansökande)</td>
        </tr>
      
        <tr>
          <td>12</td>
          <td>stakeholder</td>
          <td>fill</td>
          <td>input-personal-info</td>
          <td>customer-standard</td>
          <td>Fyll i personlig information (namn, personnummer, kontaktuppgifter)</td>
        </tr>
      
        <tr>
          <td>13</td>
          <td>stakeholder</td>
          <td>click</td>
          <td>checkbox-credit-consent</td>
          <td>customer-standard</td>
          <td>Ge samtycke till kreditupplysning</td>
        </tr>
      
        <tr>
          <td>14</td>
          <td>stakeholder</td>
          <td>click</td>
          <td>btn-submit-stakeholder</td>
          <td>customer-standard</td>
          <td>Skicka in Stakeholder-data. Systemet hämtar och utvärderar personlig information automatiskt.</td>
        </tr>
      
        <tr>
          <td>15</td>
          <td>stakeholder</td>
          <td>verify</td>
          <td>assess-stakeholder-approved</td>
          <td>customer-standard</td>
          <td>Verifiera att Assess Stakeholder DMN returnerar "APPROVED"</td>
        </tr>
      
        <tr>
          <td>16</td>
          <td>object</td>
          <td>navigate</td>
          <td>nav-object</td>
          <td>customer-standard</td>
          <td>Navigera till Object-formulär (körs sekventiellt efter Stakeholder)</td>
        </tr>
      
        <tr>
          <td>17</td>
          <td>object</td>
          <td>select</td>
          <td>select-property-type</td>
          <td>customer-standard</td>
          <td>Välj fastighetstyp (Fastighet eller Bostadsrätt)</td>
        </tr>
      
        <tr>
          <td>18</td>
          <td>object</td>
          <td>fill</td>
          <td>input-property-valuation</td>
          <td>customer-standard</td>
          <td>Fyll i fastighetsvärdering</td>
        </tr>
      
        <tr>
          <td>19</td>
          <td>object</td>
          <td>click</td>
          <td>btn-submit-object</td>
          <td>customer-standard</td>
          <td>Skicka in Object-data. Systemet utvärderar fastighet/bostadsrätt via DMN.</td>
        </tr>
      
        <tr>
          <td>20</td>
          <td>object</td>
          <td>verify</td>
          <td>evaluate-property-approved</td>
          <td>customer-standard</td>
          <td>Verifiera att Evaluate Fastighet/Bostadsrätt DMN returnerar "APPROVED"</td>
        </tr>
      
        <tr>
          <td>21</td>
          <td>confirm-application</td>
          <td>navigate</td>
          <td>nav-confirm-application</td>
          <td>customer-standard</td>
          <td>När både Household och Stakeholders är klara, navigera till Confirm application</td>
        </tr>
      
        <tr>
          <td>22</td>
          <td>confirm-application</td>
          <td>verify</td>
          <td>summary-all-data</td>
          <td>customer-standard</td>
          <td>Verifiera att sammanfattning visar all insamlad data (intern data, hushåll, stakeholder, objekt)</td>
        </tr>
      
        <tr>
          <td>23</td>
          <td>confirm-application</td>
          <td>click</td>
          <td>btn-confirm-application</td>
          <td>customer-standard</td>
          <td>Bekräfta ansökan</td>
        </tr>
      
        <tr>
          <td>24</td>
          <td>application-completed</td>
          <td>verify</td>
          <td>success-message</td>
          <td>customer-standard</td>
          <td>Verifiera att ansökan är bekräftad och processen avslutas. Ansökan går vidare till kreditevaluering.</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S2: Normalflöde – ansökan med flera stakeholders</strong> (Klicka för att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1-3</td>
          <td>application-start, internal-data-gathering</td>
          <td>navigate, verify</td>
          <td>nav-application, pre-screen-result-approved</td>
          <td>customer-multi-stakeholder</td>
          <td>Samma som S1 steg 1-3: Starta process, internal data gathering, pre-screen godkänd</td>
        </tr>
      
        <tr>
          <td>4-9</td>
          <td>household</td>
          <td>navigate, fill, click</td>
          <td>nav-household, input-household-economy, btn-submit-household</td>
          <td>customer-multi-stakeholder</td>
          <td>Samma som S1 steg 4-9: Fyll i hushållsekonomi</td>
        </tr>
      
        <tr>
          <td>10</td>
          <td>stakeholders</td>
          <td>navigate</td>
          <td>nav-stakeholders</td>
          <td>customer-multi-stakeholder</td>
          <td>Navigera till Stakeholders</td>
        </tr>
      
        <tr>
          <td>11-15</td>
          <td>stakeholder</td>
          <td>navigate, fill, click, verify</td>
          <td>nav-stakeholder, input-personal-info, btn-submit-stakeholder, assess-stakeholder-approved</td>
          <td>customer-multi-stakeholder</td>
          <td>Första stakeholder (huvudansökande) - samma som S1 steg 11-15</td>
        </tr>
      
        <tr>
          <td>16-20</td>
          <td>object</td>
          <td>navigate, select, fill, click, verify</td>
          <td>nav-object, select-property-type, input-property-valuation, btn-submit-object, evaluate-property-approved</td>
          <td>customer-multi-stakeholder</td>
          <td>Första objektet - samma som S1 steg 16-20</td>
        </tr>
      
        <tr>
          <td>21</td>
          <td>stakeholders</td>
          <td>click</td>
          <td>btn-add-stakeholder</td>
          <td>customer-multi-stakeholder</td>
          <td>Lägg till ytterligare stakeholder (sambo/medlåntagare)</td>
        </tr>
      
        <tr>
          <td>22-26</td>
          <td>stakeholder</td>
          <td>navigate, fill, click, verify</td>
          <td>nav-stakeholder, input-personal-info, btn-submit-stakeholder, assess-stakeholder-approved</td>
          <td>customer-multi-stakeholder</td>
          <td>Andra stakeholder (sambo/medlåntagare) - fyll i och verifiera godkänd</td>
        </tr>
      
        <tr>
          <td>27-31</td>
          <td>object</td>
          <td>navigate, select, fill, click, verify</td>
          <td>nav-object, select-property-type, input-property-valuation, btn-submit-object, evaluate-property-approved</td>
          <td>customer-multi-stakeholder</td>
          <td>Andra objektet (för andra stakeholder) - fyll i och verifiera godkänd</td>
        </tr>
      
        <tr>
          <td>32-34</td>
          <td>confirm-application</td>
          <td>navigate, verify, click</td>
          <td>nav-confirm-application, summary-all-data, btn-confirm-application</td>
          <td>customer-multi-stakeholder</td>
          <td>Bekräfta ansökan med flera stakeholders - samma som S1 steg 21-23</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S3: Pre-screen rejected</strong> (Klicka för att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1-2</td>
          <td>application-start, internal-data-gathering</td>
          <td>navigate</td>
          <td>nav-application, nav-internal-data</td>
          <td>customer-rejected</td>
          <td>Starta process, internal data gathering startar automatiskt</td>
        </tr>
      
        <tr>
          <td>3</td>
          <td>internal-data-gathering</td>
          <td>verify</td>
          <td>pre-screen-result-rejected</td>
          <td>customer-rejected</td>
          <td>Verifiera att Pre-screen Party DMN returnerar "REJECTED" (t.ex. för låg kreditvärdighet, ålder, anställningsstatus)</td>
        </tr>
      
        <tr>
          <td>4</td>
          <td>pre-screening-rejected</td>
          <td>verify</td>
          <td>error-message-pre-screen</td>
          <td>customer-rejected</td>
          <td>Verifiera att error event "Pre-screening rejected" triggas och processen avslutas</td>
        </tr>
      
        <tr>
          <td>5</td>
          <td>pre-screening-rejected</td>
          <td>verify</td>
          <td>rejection-reason</td>
          <td>customer-rejected</td>
          <td>Verifiera att anledning till avslag visas för kunden</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S4: Stakeholder rejected</strong> (Klicka för att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1-9</td>
          <td>application-start till household</td>
          <td>navigate, verify, fill, click</td>
          <td>nav-application, pre-screen-result-approved, input-household-economy, btn-submit-household</td>
          <td>customer-stakeholder-rejected</td>
          <td>Samma som S1 steg 1-9: Starta process, internal data OK, fyll i hushåll</td>
        </tr>
      
        <tr>
          <td>10-13</td>
          <td>stakeholders, stakeholder</td>
          <td>navigate, fill, click</td>
          <td>nav-stakeholders, nav-stakeholder, input-personal-info, checkbox-credit-consent, btn-submit-stakeholder</td>
          <td>customer-stakeholder-rejected</td>
          <td>Navigera till stakeholders, fyll i stakeholder-information (medlåntagare med dålig kreditvärdighet)</td>
        </tr>
      
        <tr>
          <td>14</td>
          <td>stakeholder</td>
          <td>verify</td>
          <td>assess-stakeholder-rejected</td>
          <td>customer-stakeholder-rejected</td>
          <td>Verifiera att Assess Stakeholder DMN returnerar "REJECTED"</td>
        </tr>
      
        <tr>
          <td>15</td>
          <td>stakeholder-rejected</td>
          <td>verify</td>
          <td>error-message-stakeholder</td>
          <td>customer-stakeholder-rejected</td>
          <td>Verifiera att error event "Stakeholder rejected" triggas och processen avslutas</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S5: Object rejected</strong> (Klicka för att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1-15</td>
          <td>application-start till stakeholder</td>
          <td>navigate, verify, fill, click</td>
          <td>nav-application, pre-screen-result-approved, input-household-economy, input-personal-info, assess-stakeholder-approved</td>
          <td>customer-object-rejected</td>
          <td>Samma som S1 steg 1-15: Starta process, internal data OK, hushåll OK, stakeholder OK</td>
        </tr>
      
        <tr>
          <td>16-18</td>
          <td>object</td>
          <td>navigate, select, fill</td>
          <td>nav-object, select-property-type, input-property-valuation</td>
          <td>customer-object-rejected</td>
          <td>Navigera till object, välj fastighetstyp, fyll i värdering (t.ex. för hög LTV, dålig belägenhet)</td>
        </tr>
      
        <tr>
          <td>19</td>
          <td>object</td>
          <td>click</td>
          <td>btn-submit-object</td>
          <td>customer-object-rejected</td>
          <td>Skicka in Object-data. Systemet utvärderar via DMN.</td>
        </tr>
      
        <tr>
          <td>20</td>
          <td>object</td>
          <td>verify</td>
          <td>evaluate-property-rejected</td>
          <td>customer-object-rejected</td>
          <td>Verifiera att Evaluate Fastighet/Bostadsrätt DMN returnerar "REJECTED"</td>
        </tr>
      
        <tr>
          <td>21</td>
          <td>object-rejected</td>
          <td>verify</td>
          <td>error-message-object</td>
          <td>customer-object-rejected</td>
          <td>Verifiera att error event "Object rejected" triggas och processen avslutas</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    
      <details style="margin: 12px 0; padding: 12px; border: 1px solid var(--border); border-radius: 6px;">
        <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">
          <strong>S6: Komplettering behövs</strong> (Klicka för att expandera)
        </summary>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Steg</th>
              <th>Page ID</th>
              <th>Action</th>
              <th>Locator ID</th>
              <th>Data Profile</th>
              <th>Kommentar</th>
            </tr>
          </thead>
          <tbody>
            
        <tr>
          <td>1-9</td>
          <td>application-start till household</td>
          <td>navigate, verify, fill</td>
          <td>nav-application, pre-screen-result-approved, input-household-economy</td>
          <td>customer-incomplete</td>
          <td>Starta process, internal data OK, börja fylla i hushållsekonomi</td>
        </tr>
      
        <tr>
          <td>10</td>
          <td>household</td>
          <td>fill</td>
          <td>input-equity-source</td>
          <td>customer-incomplete</td>
          <td>Lämna "Källa till eget kapital" tomt eller ofullständig</td>
        </tr>
      
        <tr>
          <td>11</td>
          <td>household</td>
          <td>click</td>
          <td>btn-submit-household</td>
          <td>customer-incomplete</td>
          <td>Försök skicka in Household-data med ofullständig information</td>
        </tr>
      
        <tr>
          <td>12</td>
          <td>household</td>
          <td>verify</td>
          <td>validation-error-equity-source</td>
          <td>customer-incomplete</td>
          <td>Verifiera att valideringsfel visas för saknad källa till eget kapital</td>
        </tr>
      
        <tr>
          <td>13</td>
          <td>household</td>
          <td>fill</td>
          <td>input-equity-source</td>
          <td>customer-incomplete</td>
          <td>Komplettera med källa till eget kapital</td>
        </tr>
      
        <tr>
          <td>14</td>
          <td>household</td>
          <td>click</td>
          <td>btn-submit-household</td>
          <td>customer-incomplete</td>
          <td>Skicka in kompletterad Household-data</td>
        </tr>
      
        <tr>
          <td>15-23</td>
          <td>stakeholders till confirm-application</td>
          <td>navigate, fill, click, verify</td>
          <td>nav-stakeholders, input-personal-info, btn-confirm-application</td>
          <td>customer-incomplete</td>
          <td>Fortsätt med stakeholders och objekt, bekräfta ansökan (samma som S1 steg 10-23)</td>
        </tr>
      
          </tbody>
        </table>
      </details>
    

      <h3>Testdata-referenser</h3>
      <p class="muted">Testdata-profilerna som används i scenarion. Definiera faktiska testdata i separat testdata-katalog.</p>
      <ul>
        
      <li><strong>customer-standard</strong>: Standard kundprofil för normalflöde - god kreditvärdighet, fast anställning, tillräcklig inkomst, standard fastighet med god LTV</li>
    
      <li><strong>customer-multi-stakeholder</strong>: Kundprofil med flera stakeholders (huvudansökande + sambo/medlåntagare) - båda med god kreditvärdighet, varje stakeholder har eget objekt</li>
    
      <li><strong>customer-rejected</strong>: Kundprofil som avvisas vid pre-screen - låg kreditvärdighet (&lt;600), eller ogiltig ålder, eller osäker anställningsstatus</li>
    
      <li><strong>customer-stakeholder-rejected</strong>: Kundprofil där huvudansökande är OK men medlåntagare avvisas - medlåntagare med dålig kreditvärdighet eller hög skuldsättning</li>
    
      <li><strong>customer-object-rejected</strong>: Kundprofil där kund och stakeholder är OK men fastighet avvisas - för hög LTV (&gt;85%), dålig belägenhet, eller hög föreningsskuld (bostadsrätt)</li>
    
      <li><strong>customer-incomplete</strong>: Kundprofil med ofullständig information - saknar viktiga fält som källa till eget kapital, eller ofullständiga låneuppgifter</li>
    
      </ul>

      <h3>Implementation Mapping</h3>
      <p class="muted">Mappning mellan BPMN-aktiviteter och faktisk implementation (routes, endpoints, locators).</p>
      <table>
        <thead>
          <tr>
            <th>BPMN Aktivitet</th>
            <th>Type</th>
            <th>Route/Endpoint</th>
            <th>Method</th>
            <th>Base URL</th>
            <th>Kommentar</th>
          </tr>
        </thead>
        <tbody>
          
      <tr>
        <td>Application (start)</td>
        <td>UI</td>
        <td>/mortgage/application</td>
        <td>GET</td>
        <td>https://portal.sbab.se</td>
        <td>Startpunkt för Application-processen. Anropas från Mortgage huvudprocess.</td>
      </tr>
    
      <tr>
        <td>Internal data gathering</td>
        <td>API + UI</td>
        <td>/api/application/internal-data-gathering<br>/mortgage/application/internal-data</td>
        <td>POST (API)<br>GET (UI)</td>
        <td>https://api.sbab.se<br>https://portal.sbab.se</td>
        <td>Hämtar befintlig kunddata från interna system (part, engagemang, kreditinformation). Körs automatiskt som multi-instance per part. Anropar Pre-screen Party DMN.</td>
      </tr>
    
      <tr>
        <td>Household</td>
        <td>Both</td>
        <td>/api/application/household<br>/mortgage/application/household</td>
        <td>POST (API)<br>GET/POST (UI)</td>
        <td>https://api.sbab.se<br>https://portal.sbab.se</td>
        <td>Samlar in hushållsekonomi, personlig ekonomi, källa till eget kapital och låneuppgifter. Körs parallellt med Stakeholders som multi-instance.</td>
      </tr>
    
      <tr>
        <td>Stakeholders (subprocess)</td>
        <td>UI</td>
        <td>/mortgage/application/stakeholders</td>
        <td>GET</td>
        <td>https://portal.sbab.se</td>
        <td>Översiktssida för alla stakeholders. Hanterar multi-instance för flera stakeholders.</td>
      </tr>
    
      <tr>
        <td>Stakeholder</td>
        <td>Both</td>
        <td>/api/application/stakeholder<br>/mortgage/application/stakeholder</td>
        <td>POST (API)<br>GET/POST (UI)</td>
        <td>https://api.sbab.se<br>https://portal.sbab.se</td>
        <td>Registrerar personlig information, samtycke till kreditupplysning. Systemet hämtar och utvärderar personlig information automatiskt. Anropar Assess Stakeholder DMN.</td>
      </tr>
    
      <tr>
        <td>Object</td>
        <td>Both</td>
        <td>/api/application/object<br>/mortgage/application/object</td>
        <td>POST (API)<br>GET/POST (UI)</td>
        <td>https://api.sbab.se<br>https://portal.sbab.se</td>
        <td>Hanterar fastighetsinformation (fastighetstyp, värdering, säkerhetsregistrering). Anropar Evaluate Fastighet eller Evaluate Bostadsrätt DMN beroende på fastighetstyp.</td>
      </tr>
    
      <tr>
        <td>Confirm application</td>
        <td>UI</td>
        <td>/mortgage/application/confirm</td>
        <td>GET/POST</td>
        <td>https://portal.sbab.se</td>
        <td>User task där kunden bekräftar att all information är korrekt. Visar sammanfattning av all insamlad data. När bekräftad, avslutas Application-processen och ansökan går vidare till kreditevaluering.</td>
      </tr>
    
      <tr>
        <td>Pre-screen Party (DMN)</td>
        <td>API</td>
        <td>/api/dmn/pre-screen-party</td>
        <td>POST</td>
        <td>https://api.sbab.se</td>
        <td>DMN-beslutsregel för initial eligibility check. Input: Age, Credit Score, Employment Status. Output: APPROVED / REJECTED / REVIEW.</td>
      </tr>
    
      <tr>
        <td>Assess Stakeholder (DMN)</td>
        <td>API</td>
        <td>/api/dmn/assess-stakeholder</td>
        <td>POST</td>
        <td>https://api.sbab.se</td>
        <td>DMN-beslutsregel för att utvärdera borrower capacity. Input: Annual Income, DTI Ratio, Credit History. Output: APPROVED / REJECTED + Risk Category.</td>
      </tr>
    
      <tr>
        <td>Evaluate Fastighet (DMN)</td>
        <td>API</td>
        <td>/api/dmn/evaluate-fastighet</td>
        <td>POST</td>
        <td>https://api.sbab.se</td>
        <td>DMN-beslutsregel för hus-evaluering. Input: Property Value, Condition, LTV, Location. Output: APPROVED / REJECTED + Risk Level.</td>
      </tr>
    
      <tr>
        <td>Evaluate Bostadsrätt (DMN)</td>
        <td>API</td>
        <td>/api/dmn/evaluate-bostadsratt</td>
        <td>POST</td>
        <td>https://api.sbab.se</td>
        <td>DMN-beslutsregel för bostadsrätt-evaluering. Input: Apartment Value, Association Debt, LTV. Output: APPROVED / REJECTED + Risk Level.</td>
      </tr>
    
        </tbody>
      </table>
    </section>
  

  
  </div>
  </body>
</html>
